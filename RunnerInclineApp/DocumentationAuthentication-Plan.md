# Authentication Integration Plan - Sprint 2.5

## ğŸ¯ Goal
Add Sign in with Apple authentication to secure course uploads and provide user ownership.

## ğŸ“‹ Implementation Steps

### 1. Update Course Model
```swift
struct Course: Identifiable, Codable {
    let id: UUID
    let name: String
    let city: String?
    let distance_miles: Double?
    let total_elevation_gain_ft: Double?
    let gpx_url: String?
    let source_type: String?
    let source_link: String?
    let verified: Bool
    let created_at: String?
    let created_by: UUID?  // New field
}
```

### 2. Create AuthenticationManager
- Sign in with Apple integration
- Supabase auth session management
- User state persistence

### 3. Update SupabaseService
- Include `created_by` field in course creation
- Handle authenticated requests
- Manage auth tokens

### 4. Update UI Flow
- Add authentication gate before upload
- Show user profile/sign out options
- Handle unauthenticated states

### 5. Enhanced Security
- Only show user's own unverified courses
- Admin verification workflow
- Proper RLS policies

## ğŸ” Authentication Flow

```
User opens app
    â†“
Browse public verified courses (no auth needed)
    â†“
User wants to upload course
    â†“
Show Sign in with Apple
    â†“
Authenticated â†’ Allow upload
    â†“
Course created with user ID
    â†“
Segments generated by Edge Function
    â†“
User can see their course (unverified)
    â†“
Admin can verify course â†’ becomes public
```

## ğŸ“± UI Components to Create
- `AuthenticationView` - Sign in with Apple
- `UserProfileView` - Profile management
- `AuthenticationManager` - Auth state management
- Updated `GPXUploadView` - Auth-required upload

## ğŸš€ Benefits
- âœ… Secure course creation
- âœ… User ownership tracking  
- âœ… Spam prevention
- âœ… Admin moderation capability
- âœ… Personalized experience